import D from"./index-ada367b6.mjs";import{_ as C,d as F,a3 as x,a5 as M,o as b,C as S,ae as U,af as A,y as t,x as s,f as _,c as E,L as O,M as q,e as d,N as L,b as w,I as B,ag as J,ah as I,j as Q,Q as W,ai as Y,aj as K,ak as X,J as Z,ad as ee}from"./entry-72ed921d.mjs";import H from"./index-06326317.mjs";import te from"./index-89f062c4.mjs";import $ from"./index-0d758ab1.mjs";import ne from"./index-27de668c.mjs";import oe from"./index-6cdd2bbb.mjs";import le from"./index-cd72c9a8.mjs";import se from"./index-117dc858.mjs";import ae from"./index-8b81196e.mjs";import ie from"./index-9ff07ac3.mjs";import re from"./index-37e2f893.mjs";import _e from"./index-b88d6ca9.mjs";const ce=F({__name:"run-select",props:{modelValue:null,runs:null},emits:["update:modelValue"],setup(u,{expose:o,emit:n}){o();const e=u;let p=x(e.modelValue);M(p,l=>{n("update:modelValue",l)});function g(l){var h,v;if(!l||typeof l=="string")return"";let c=U((v=(h=l.rta)==null?void 0:h.asSeconds())!=null?v:0,2)+" RTA";l.igt&&(c=U(l.igt.asSeconds(),2)+" IGT / "+c);const a=l.id?" #"+l.id:"";let f=`${c}, ${l.ended.fromNow()}`+a;return(l.isStartedSynced===!1||l.isEndedSynced===!1)&&(f+=" (unsynced)"),f}const r={props:e,emits:n,selected:p,renderRunLabel:g};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}});function de(u,o,n,e,p,g){const r=$;return b(),S(r,{modelValue:e.selected,"onUpdate:modelValue":o[0]||(o[0]=l=>e.selected=l),options:e.props.runs,label:e.renderRunLabel,placeholder:"Choose something..."},null,8,["modelValue","options"])}var ue=C(ce,[["render",de]]);function me(u){throw new Error("Unexpected object: "+u)}const fe=F({__name:"run-selection",props:{selectedRun:null,runs:null,segments:null},emits:["update:selectedRun"],setup(u,{expose:o,emit:n}){o();const e=u,p={FULL_GAME:"full-game",SEGMENT:"segment"},g=i=>i&&i.length>0,r=x(p.FULL_GAME),l=x(g(e.runs)?e.runs[0]:null),c=x(g(e.segments)?e.segments[0]:null),a=A(()=>{var i,k,T;return(T=(k=(i=c.value)==null?void 0:i.getHistory(20))==null?void 0:k.map(V=>V.ToRun()).filter(V=>V!==null))!=null?T:[]}),f=x(a.value.length>0?a.value[0]:null),h=A(()=>{switch(r.value){case p.FULL_GAME:return l.value;case p.SEGMENT:return f.value;default:return me(r.value)}});h.value!=e.selectedRun&&n("update:selectedRun",h.value),M(h,i=>{n("update:selectedRun",i)});const v={props:e,emits:n,tabs:p,notEmpty:g,activeTab:r,selectedFullRun:l,selectedSegment:c,segmentAttempts:a,selectedSegmentAttempt:f,selectedRun:h};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),pe=_(" Runs "),he=_(" Segments "),ge=_("Pick a run:"),be=_("Segment:"),ve=_("Which time?");function xe(u,o,n,e,p,g){const r=te,l=D,c=ue,a=H,f=ne,h=$,v=oe;return b(),S(v,{modelValue:e.activeTab,"onUpdate:modelValue":o[3]||(o[3]=i=>e.activeTab=i),model:"tab-1"},{header:t(()=>[s(r,{for:e.tabs.FULL_GAME},{default:t(()=>[pe]),_:1},8,["for"]),s(r,{for:e.tabs.SEGMENT},{default:t(()=>[he]),_:1},8,["for"])]),default:t(()=>[s(f,{name:e.tabs.FULL_GAME},{default:t(()=>[s(a,null,{default:t(()=>[s(l,null,{default:t(()=>[ge]),_:1}),s(c,{modelValue:e.selectedFullRun,"onUpdate:modelValue":o[0]||(o[0]=i=>e.selectedFullRun=i),runs:e.props.runs},null,8,["modelValue","runs"])]),_:1})]),_:1},8,["name"]),s(f,{name:e.tabs.SEGMENT},{default:t(()=>[s(a,null,{default:t(()=>[s(l,null,{default:t(()=>[be]),_:1}),s(h,{modelValue:e.selectedSegment,"onUpdate:modelValue":o[1]||(o[1]=i=>e.selectedSegment=i),options:e.props.segments,label:i=>i.name,placeholder:"Choose something..."},null,8,["modelValue","options","label"])]),_:1}),s(a,null,{default:t(()=>[s(l,null,{default:t(()=>[ve]),_:1}),s(c,{modelValue:e.selectedSegmentAttempt,"onUpdate:modelValue":o[2]||(o[2]=i=>e.selectedSegmentAttempt=i),runs:e.segmentAttempts},null,8,["modelValue","runs"])]),_:1})]),_:1},8,["name"])]),_:1},8,["modelValue"])}var ye=C(fe,[["render",xe]]);const Se=F({__name:"highlighter-results",props:{highlights:null},setup(u,{expose:o}){o();const e={props:u};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}}),Ve={class:"component-container"},Re=["src"],we={class:"highlight-description _flex-grow:1 _display:flex _flex-direction:column _justify-content:space-between"},ke={class:"video-title"},Te={key:0,class:"_font-size:xs run-part"},Ee={class:"_display:flex _flex_direction:row _align-items:end"},Le={class:"_flex-grow:1"},Me=_("Start: "),Ue={class:"highlight-timestamp"},Ae=_("End:\xA0 "),Ce={class:"highlight-timestamp"},Fe={class:"_margin-left:auto"},Pe=_("Open Highlighter");function Ne(u,o,n,e,p,g){const r=B,l=le,c=se;return b(),E("div",Ve,[s(c,null,{default:t(()=>[(b(!0),E(O,null,q(e.props.highlights,(a,f)=>(b(),S(l,{class:"_display:flex _flex-direction:row"},{default:t(()=>[d("img",{class:"highlight-thumbnail",src:a.getThumbnailUrl(void 0,200),alt:"Video thumbnail"},null,8,Re),d("div",we,[d("div",null,[d("p",ke,L(a.videoTitle),1),e.props.highlights.length>1?(b(),E("p",Te,"Part "+L(f+1),1)):w("",!0)]),d("div",Ee,[d("div",Le,[d("p",null,[Me,d("span",Ue,L(U(a.start_time)),1)]),d("p",null,[Ae,d("span",Ce,L(U(a.end_time)),1)])]),d("div",Fe,[s(r,{target:"_blank",color:"secondary",href:a.getPrefilledHighlighterLink()},{default:t(()=>[Pe]),_:2},1032,["href"])])])])]),_:2},1024))),256))]),_:1})])}var Ge=C(Se,[["render",Ne],["__scopeId","data-v-385e6ed0"]]);const je=F({__name:"index",setup(u,{expose:o}){o();const n=J(),e=x(!1),p=x(null),g=x(!1),r=x(null),l=x(null),c=x(!1);let a=new AbortController;function f(){var m;(m=p.value)==null||m.click()}function h(){n.selectedRun=null,n.game={}}const v=A(()=>n.game.runs&&n.game.segments);async function i(m){m.preventDefault(),m.target.blur(),n.enableDemoMode()}async function k(m){var G,j;const R=m.target,z=(j=(G=R==null?void 0:R.files)==null?void 0:G.length)!=null?j:0>0;n.file=z?R.files[0]:null}M(()=>n.file,async m=>{try{if(h(),!m)return;g.value=!0,await n.loadFile(m)}finally{g.value=!1}});const T=I();async function V(){if(n.selectedRun!=null){if(I().isDemoMode){c.value=!0;return}e.value=!0,a=new AbortController;try{r.value=await Y(n.selectedRun,a.signal,n.channel)}catch(m){a.signal.aborted||(l.value=m)}finally{e.value=!1}}}const y=A(()=>{var R;if(!((R=n.file)!=null&&R.name))return"No file selected.";let m="";return n.game.name&&(m=` - ${n.game.name}`,n.game.category&&(m+=` (${n.game.category})`)),n.file.name+m});M(()=>n.selectedRun,()=>{a.abort(),r.value=null,e.value=!1,l.value=null});const N={state:n,isLoading:e,fileInput:p,isParsing:g,highlights:r,error:l,demoModalVisible:c,abortController:a,openFileSelector:f,resetFileSelection:h,fileParsed:v,enableDemoMode:i,fileChange:k,authStore:T,submitted:V,fileText:y};return Object.defineProperty(N,"__isScriptSetup",{enumerable:!1,value:!0}),N}}),P=u=>(K("data-v-7fbbae48"),u=u(),X(),u),Ie=_("Channel:"),De=_(" Splits file ("),Oe=P(()=>d("a",{href:"https://livesplit.org/",target:"_blank"},"LiveSplit",-1)),Be=_(" only): "),He=_(" Select file "),$e=_(" Parsing... "),ze=["src"],qe=P(()=>d("div",{class:"_margin:2/3"},null,-1)),Je=_(" Search "),Qe=_(" Searching... "),We={class:"message-container"},Ye=P(()=>d("span",{class:"card-header"},"Not found",-1)),Ke=P(()=>d("p",null,[_("The run was not found in the archives of this channel."),d("br"),_(" The video archive may have expired. ")],-1)),Xe=_(" An unexpected error occured. "),Ze=_(" Demo mode "),et=_(" You cannot search in demo mode. ");function tt(u,o,n,e,p,g){const r=D,l=Z,c=H,a=ee,f=B,h=ye,v=Ge,i=ae,k=ie,T=re,V=_e;return b(),S(V,null,{default:t(()=>[s(k,{onSubmit:e.submitted},{default:t(()=>[s(c,null,{default:t(()=>[s(r,null,{default:t(()=>[Ie]),_:1}),s(l,{modelValue:e.state.channel,"onUpdate:modelValue":o[0]||(o[0]=y=>e.state.channel=y),clearable:"",placeholder:"Twitch Username",required:""},null,8,["modelValue"])]),_:1}),s(c,null,{default:t(()=>[s(r,null,{default:t(()=>[De,Oe,Be]),_:1}),!e.isParsing&&!e.fileParsed?(b(),E("a",{key:0,href:"#",class:"_float:right _font-size:sm _vertical-align:bottom",onClick:e.enableDemoMode},"Use demo splits")):w("",!0),d("input",{ref:"fileInput",type:"file",onChange:e.fileChange,style:{display:"none"},accept:".lss"},null,544),s(l,{placeholder:e.fileText,onClick:o[1]||(o[1]=Q(y=>y.target.blur(),["prevent"])),plaintext:!0},W({prepend:t(()=>[s(f,{type:"button",onClick:e.openFileSelector,loading:e.isParsing},{loading:t(()=>[s(a,{class:"_margin-right:1/2"}),$e]),default:t(()=>[He]),_:1},8,["loading"])]),_:2},[e.state.game.icon?{name:"suffix",fn:t(()=>[d("img",{src:e.state.game.icon,alt:"Game icon",style:{"max-height":"40px","object-fit":"contain"}},null,8,ze)])}:void 0]),1032,["placeholder"]),qe]),_:1}),e.fileParsed?(b(),E(O,{key:0},[s(c,{class:"_margin-bottom:2"},{default:t(()=>[s(h,{selectedRun:e.state.selectedRun,"onUpdate:selectedRun":o[2]||(o[2]=y=>e.state.selectedRun=y),runs:e.state.game.runs,segments:e.state.game.segments},null,8,["selectedRun","runs","segments"])]),_:1}),!e.error&&!e.highlights?(b(),S(c,{key:0,class:"_display:flex _justify-content:center"},{default:t(()=>[s(f,{color:"primary",type:"submit",loading:e.isLoading},{loading:t(()=>[s(a,{class:"_margin-right:1/2"}),Qe]),default:t(()=>[Je]),_:1},8,["loading"])]),_:1})):w("",!0)],64)):w("",!0),e.highlights&&e.highlights.length>0?(b(),S(v,{key:1,highlights:e.highlights},null,8,["highlights"])):w("",!0),d("div",We,[e.highlights&&e.highlights.length==0?(b(),S(i,{key:0,class:"highlight-notfound",color:"warning"},{header:t(()=>[Ye]),default:t(()=>[Ke]),_:1})):w("",!0),e.error?(b(),S(i,{key:1,color:"danger"},{default:t(()=>[Xe]),_:1})):w("",!0)])]),_:1}),s(T,{modelValue:e.demoModalVisible,"onUpdate:modelValue":o[3]||(o[3]=y=>e.demoModalVisible=y)},{header:t(()=>[Ze]),default:t(()=>[et]),_:1},8,["modelValue"])]),_:1})}var pt=C(je,[["render",tt],["__scopeId","data-v-7fbbae48"]]);export{pt as default};
